#!/usr/bin/env python3
from typing import List, Tuple

Coord = Tuple[int, int, int]

# ============================================================
# 1. HARD-CODE YOUR COORDINATES HERE
# ============================================================
# NOTE: Borrowed north debt is cleared by coordinate [-324, 214, 318]
#       All coordinates after that point are okay.

COORDS: List[Coord] = [
    [-226, 130, 326],
    [-227, 130, 325],
    [-227, 131, 325],
    [-228, 131, 324],
    [-228, 132, 324],
    [-229, 132, 323],
    [-229, 133, 322],
    [-230, 133, 322],
    [-230, 134, 321],
    [-231, 134, 321],
    [-232, 135, 320],
    [-232, 135, 320],
    [-233, 136, 319],
    [-233, 136, 319],
    [-234, 137, 318],
    [-234, 137, 318],
    [-235, 138, 317],
    [-236, 138, 317],
    [-236, 139, 316],
    [-237, 139, 316],
    [-238, 140, 315],
    [-238, 140, 315],
    [-239, 141, 314],
    [-239, 141, 314],
    [-240, 142, 313],
    [-241, 142, 313],
    [-241, 143, 312],
    [-242, 143, 312],
    [-243, 144, 312],
    [-243, 144, 311],
    [-244, 145, 311],
    [-245, 145, 310],
    [-245, 146, 310],
    [-246, 147, 309],
    [-247, 147, 309],
    [-247, 148, 309],
    [-248, 148, 308],
    [-249, 149, 308],
    [-250, 149, 307],
    [-250, 150, 307],
    [-251, 150, 307],
    [-252, 151, 306],
    [-252, 151, 306],
    [-253, 152, 306],
    [-254, 152, 305],
    [-255, 153, 305],
    [-255, 153, 305],
    [-256, 154, 304],
    [-257, 154, 304],
    [-257, 155, 304],
    [-258, 155, 303],
    [-259, 156, 303],
    [-260, 157, 303],
    [-260, 157, 302],
    [-261, 158, 302],
    [-262, 158, 302],
    [-263, 159, 302],
    [-263, 159, 301],
    [-264, 160, 301],
    [-265, 160, 301],
    [-266, 161, 301],
    [-266, 161, 300],
    [-267, 162, 300],
    [-268, 162, 300],
    [-269, 163, 300],
    [-269, 163, 300],
    [-270, 164, 299],
    [-271, 165, 299],
    [-272, 165, 299],
    [-272, 166, 299],
    [-273, 166, 299],
    [-274, 167, 298],
    [-274, 167, 298],
    [-275, 168, 298],
    [-276, 168, 298],
    [-277, 169, 298],
    [-277, 169, 298],
    [-278, 170, 298],
    [-279, 170, 297],
    [-279, 171, 297],
    [-280, 171, 297],
    [-281, 172, 297],
    [-282, 172, 297],
    [-282, 173, 297],
    [-283, 173, 297],
    [-284, 174, 297],
    [-284, 175, 297],
    [-285, 175, 297],
    [-286, 176, 297],
    [-286, 176, 296],
    [-287, 177, 296],
    [-288, 177, 296],
    [-288, 178, 296],
    [-289, 178, 296],
    [-290, 179, 296],
    [-290, 179, 296],
    [-291, 180, 296],
    [-291, 180, 296],
    [-292, 181, 296],
    [-293, 181, 296],
    [-293, 182, 296],
    [-294, 182, 296],
    [-295, 183, 296],
    [-295, 183, 296],
    [-296, 184, 297],
    [-296, 184, 297],
    [-297, 185, 297],
    [-297, 185, 297],
    [-298, 186, 297],
    [-299, 186, 297],
    [-299, 187, 297],
    [-300, 187, 297],
    [-300, 188, 297],
    [-301, 188, 297],
    [-301, 189, 297],
    [-302, 189, 298],
    [-302, 190, 298],
    [-303, 190, 298],
    [-303, 190, 298],
    [-304, 191, 298],
    [-304, 191, 298],
    [-305, 192, 298],
    [-305, 192, 299],
    [-306, 193, 299],
    [-306, 193, 299],
    [-306, 194, 299],
    [-307, 194, 299],
    [-307, 195, 300],
    [-308, 195, 300],
    [-308, 196, 300],
    [-309, 196, 300],
    [-309, 196, 300],
    [-309, 197, 301],
    [-310, 197, 301],
    [-310, 198, 301],
    [-311, 198, 301],
    [-311, 199, 302],
    [-311, 199, 302],
    [-312, 199, 302],
    [-312, 200, 302],
    [-313, 200, 303],
    [-313, 201, 303],
    [-313, 201, 303],
    [-314, 202, 304],
    [-314, 202, 304],
    [-314, 202, 304],
    [-315, 203, 305],
    [-315, 203, 305],
    [-315, 204, 305],
    [-316, 204, 306],
    [-316, 204, 306],
    [-316, 205, 306],
    [-317, 205, 307],
    [-317, 205, 307],
    [-317, 206, 307],
    [-317, 206, 308],
    [-318, 207, 308],
    [-318, 207, 308],
    [-318, 207, 309],
    [-319, 208, 309],
    [-319, 208, 310],
    [-319, 208, 310],
    [-319, 209, 311],
    [-320, 209, 311],
    [-320, 209, 311],
    [-320, 210, 312],
    [-320, 210, 312],
    [-321, 210, 313],
    [-321, 211, 313],
    [-321, 211, 314],
    [-321, 211, 314],
    [-322, 212, 314],
    [-322, 212, 315],
    [-322, 212, 315],
    [-322, 213, 316],
    [-322, 213, 316],
    [-323, 213, 317],
    [-323, 213, 317],
    [-323, 214, 318],
    [-323, 214, 318],
    [-324, 214, 319],
    [-324, 215, 319],
    [-324, 215, 320],
    [-324, 215, 320],
    [-324, 215, 321],
    [-325, 216, 321],
    [-325, 216, 322],
    [-325, 216, 323],
    [-325, 216, 323],
    [-325, 217, 324],
    [-326, 217, 324],
    [-326, 217, 325],
    [-326, 217, 325],
    [-326, 217, 326],
    [-326, 218, 326],
    [-326, 218, 327],
    [-327, 218, 328],
    [-327, 218, 328],
    [-327, 219, 329],
    [-327, 219, 329],
    [-327, 219, 330],
    [-327, 219, 331],
    [-327, 219, 331],
    [-328, 219, 332],
    [-328, 220, 332],
    [-328, 220, 333],
    [-328, 220, 334],
    [-328, 220, 334],
    [-328, 220, 335],
    [-328, 220, 336],
    [-329, 220, 336],
    [-329, 221, 337],
    [-329, 221, 338],
    [-329, 221, 338],
    [-329, 221, 339],
    [-329, 221, 340],
    [-329, 221, 340],
    [-329, 221, 341],
    [-329, 221, 342],
    [-329, 221, 342],
    [-329, 221, 343],
    [-330, 222, 344],
    [-330, 222, 344],
    [-330, 222, 345],
    [-330, 222, 346],
    [-330, 222, 346],
    [-330, 222, 347],
    [-330, 222, 348],
    [-330, 222, 348],
    [-330, 222, 349],
    [-330, 222, 350],
    [-330, 222, 351],
    [-330, 222, 351],
    [-330, 222, 352]

]

# ============================================================
# 2. CONFIGURATION
# ============================================================

ANCHOR_INDEX = 0        # index of [-226, 130, 326] in COORDS
NORTHMOST_Z = 296       # original northmost turning value
MAX_EXTRA_NORTH = 894     # how many extra north steps we allow to borrow

# ============================================================
# 3. UTILITY FUNCTIONS
# ============================================================

def step_dir(a: Coord, b: Coord) -> Tuple[int, int]:
    """Return (dx, dz) horizontal direction."""
    return (b[0] - a[0], b[2] - a[2])

def is_west(dx: int, dz: int) -> bool:
    return dx == -1 and dz == 0

def is_north(dx: int, dz: int) -> bool:
    return dx == 0 and dz == -1

def is_south(dx: int, dz: int) -> bool:
    return dx == 0 and dz == 1

# ============================================================
# 4. MAIN TRANSFORMATION
# ============================================================

def stretch_z(coords: List[Coord]) -> List[Coord]:
    output: List[Coord] = []

    # Copy fixed prefix
    output.extend(coords[:ANCHOR_INDEX + 1])

    borrowed_north = 0
    paying_back = False

    for i in range(ANCHOR_INDEX + 1, len(coords)):
        prev = output[-1]
        curr = coords[i]

        dx, dz = step_dir(coords[i - 1], curr)

        x, y, z = curr

        # ----------------------------------------------------
        # Phase switch: original northmost Z reached
        # ----------------------------------------------------
        if curr[2] == NORTHMOST_Z:
            paying_back = True

        # ----------------------------------------------------
        # Borrow north BEFORE phase switch
        # ----------------------------------------------------
        if not paying_back and borrowed_north < MAX_EXTRA_NORTH:
            # Only borrow when original step is not already north
            if not is_north(dx, dz):
                # Insert extra north block (flat in Y)
                nx = prev[0]
                ny = prev[1]
                nz = prev[2] - borrowed_north
                output.append((nx, ny, nz))
                borrowed_north += 1
                prev = output[-1]

        # ----------------------------------------------------
        # Pay back south AFTER phase switch
        # ----------------------------------------------------
        if paying_back and borrowed_north > 0:
            # If original step is heading south already, let it
            if not is_south(dx, dz):
                # Insert extra south block (flat in Y)
                nx = prev[0]
                ny = prev[1]
                nz = prev[2] - borrowed_north
                output.append((nx, ny, nz))
                borrowed_north -= 1
                prev = output[-1]

        # ----------------------------------------------------
        # Append original step (if not duplicate)
        # ----------------------------------------------------
        if curr != prev:
            output.append(curr)

    return output

# ============================================================
# 5. RUN + PRINT RESULT
# ============================================================

def main():
    new_coords = stretch_z(COORDS)

    print("New coordinate list:\n")
    for c in new_coords:
        print(f"[{c[0]}, {c[1]}, {c[2]}]")

    print("\nSummary:")
    print(f"Original count: {len(COORDS)}")
    print(f"New count:      {len(new_coords)}")

if __name__ == "__main__":
    main()
