#!/usr/bin/env python3
from typing import List, Tuple

Coord = Tuple[int, int, int]

# ============================================================
# 1. HARD-CODE YOUR COORDINATES HERE
# ============================================================
# NOTE: Borrowed north debt is cleared by coordinate [-324, 214, 318]
#       All coordinates after that point are okay.

COORDS_BEGIN: List[Coord] = [
[-199, 98, 410],
[-199, 98, 409],
[-199, 98, 409],
[-199, 98, 408],
[-199, 98, 407],
[-199, 98, 406],
[-199, 98, 406],
[-199, 98, 405],
[-199, 98, 404],
[-199, 98, 403],
[-199, 98, 403],
[-199, 98, 402],
[-199, 98, 401],
[-200, 99, 400],
[-200, 99, 400],
[-200, 99, 399],
[-200, 99, 398],
[-200, 99, 397],
[-200, 99, 397],
[-200, 99, 396],
[-200, 99, 395],
[-200, 99, 394],
[-200, 99, 394],
[-200, 100, 393],
[-201, 100, 392],
[-201, 100, 391],
[-201, 100, 391],
[-201, 100, 390],
[-201, 100, 389],
[-201, 100, 388],
[-201, 101, 387],
[-202, 101, 387],
[-202, 101, 386],
[-202, 101, 385],
[-202, 101, 384],
[-202, 101, 384],
[-202, 102, 383],
[-202, 102, 382],
[-203, 102, 381],
[-203, 102, 380],
[-203, 103, 380],
[-203, 103, 379],
[-203, 103, 378],
[-203, 103, 377],
[-204, 103, 377],
[-204, 104, 376],
[-204, 104, 375],
[-204, 104, 374],
[-204, 104, 374],
[-205, 105, 373],
[-205, 105, 372],
[-205, 105, 371],
[-205, 105, 370],
[-205, 106, 370],
[-206, 106, 369],
[-206, 106, 368],
[-206, 107, 367],
[-206, 107, 367],
[-207, 107, 366],
[-207, 107, 365],
[-207, 108, 364],
[-207, 108, 364],
[-207, 108, 363],
[-208, 109, 362],
[-208, 109, 361],
[-208, 109, 361],
[-208, 110, 360],
[-209, 110, 359],
[-209, 110, 358],
[-209, 111, 358],
[-209, 111, 357],
[-210, 111, 356],
[-210, 112, 355],
[-210, 112, 355],
[-210, 112, 354],
[-211, 113, 353],
[-211, 113, 352],
[-211, 113, 352],
[-212, 114, 351],
[-212, 114, 350],
[-212, 115, 349],
[-212, 115, 349],
[-213, 115, 348],
[-213, 116, 347],
[-213, 116, 347],
[-214, 116, 346],
[-214, 117, 345],
[-214, 117, 345],
[-215, 118, 344],
[-215, 118, 343],
[-215, 118, 342],
[-216, 119, 342],
[-216, 119, 341],
[-216, 120, 340],
[-217, 120, 340],
[-217, 121, 339],
[-218, 121, 338],
[-218, 121, 338],
[-218, 122, 337],
[-219, 122, 336],
[-219, 123, 336],
[-220, 123, 335],
[-220, 124, 334],
[-221, 124, 333],
[-221, 125, 333],
[-222, 125, 332],
[-222, 126, 331],
[-223, 126, 331],
[-223, 127, 330],
[-223, 127, 329],
[-224, 128, 329],
[-224, 128, 328],
[-225, 129, 328],
[-225, 129, 327],
[-226, 130, 326]
]

COORDS_END: List[Coord] = [
[-324, 214, 318],
[-324, 215, 319],
[-324, 215, 320],
[-324, 215, 321],
[-325, 216, 321],
[-325, 216, 322],
[-325, 216, 323],
[-325, 217, 324],
[-326, 217, 324],
[-326, 217, 325],
[-326, 217, 326],
[-326, 218, 326],
[-326, 218, 327],
[-327, 218, 328],
[-327, 219, 329],
[-327, 219, 330],
[-327, 219, 331],
[-328, 219, 332],
[-328, 220, 332],
[-328, 220, 333],
[-328, 220, 334],
[-328, 220, 335],
[-328, 220, 336],
[-329, 220, 336],
[-329, 221, 337],
[-329, 221, 338],
[-329, 221, 339],
[-329, 221, 340],
[-329, 221, 341],
[-329, 221, 342],
[-329, 221, 343],
[-330, 222, 344],
[-330, 222, 345],
[-330, 222, 346],
[-330, 222, 347],
[-330, 222, 348],
[-330, 222, 349],
[-330, 222, 350],
[-330, 222, 351],
[-330, 222, 352]
]

# ============================================================
# 2. CONFIGURATION
# ============================================================

ANCHOR_INDEX = 0        # index of [-226, 130, 326] in COORDS
NORTHMOST_Z = 296       # original northmost turning value
MAX_EXTRA_NORTH = 894     # how many extra north steps we allow to borrow

# ============================================================
# 3. UTILITY FUNCTIONS
# ============================================================

def step_dir(a: Coord, b: Coord) -> Tuple[int, int]:
    """Return (dx, dz) horizontal direction."""
    return (b[0] - a[0], b[2] - a[2])

def is_west(dx: int, dz: int) -> bool:
    return dx == -1 and dz == 0

def is_north(dx: int, dz: int) -> bool:
    return dx == 0 and dz == -1

def is_south(dx: int, dz: int) -> bool:
    return dx == 0 and dz == 1

# ============================================================
# 4. MAIN TRANSFORMATION
# ============================================================

def stretch_z(coords: List[Coord]) -> List[Coord]:
    output: List[Coord] = []

    # Copy fixed prefix
    output.extend(coords[:ANCHOR_INDEX + 1])

    borrowed_north = 0
    paying_back = False

    for i in range(ANCHOR_INDEX + 1, len(coords)):
        prev = output[-1]
        curr = coords[i]

        dx, dz = step_dir(coords[i - 1], curr)

        x, y, z = curr

        # ----------------------------------------------------
        # Phase switch: original northmost Z reached
        # ----------------------------------------------------
        if curr[2] == NORTHMOST_Z:
            paying_back = True

        # ----------------------------------------------------
        # Borrow north BEFORE phase switch
        # ----------------------------------------------------
        if not paying_back and borrowed_north < MAX_EXTRA_NORTH:
            # Only borrow when original step is not already north
            if not is_north(dx, dz):
                # Insert extra north block (flat in Y)
                nx = prev[0]
                ny = prev[1]
                nz = prev[2] - borrowed_north
                output.append((nx, ny, nz))
                borrowed_north += 1
                prev = output[-1]

        # ----------------------------------------------------
        # Pay back south AFTER phase switch
        # ----------------------------------------------------
        if paying_back and borrowed_north > 0:
            # If original step is heading south already, let it
            if not is_south(dx, dz):
                # Insert extra south block (flat in Y)
                nx = prev[0]
                ny = prev[1]
                nz = prev[2] - borrowed_north
                output.append((nx, ny, nz))
                borrowed_north -= 1
                prev = output[-1]

        # ----------------------------------------------------
        # Append original step (if not duplicate)
        # ----------------------------------------------------
        if curr != prev:
            output.append(curr)

    return output

# ============================================================
# 5. RUN + PRINT RESULT
# ============================================================

def main():
    new_coords = stretch_z(COORDS)

    print("New coordinate list:\n")
    for c in new_coords:
        print(f"[{c[0]}, {c[1]}, {c[2]}]")

    print("\nSummary:")
    print(f"Original count: {len(COORDS)}")
    print(f"New count:      {len(new_coords)}")

if __name__ == "__main__":
    main()
